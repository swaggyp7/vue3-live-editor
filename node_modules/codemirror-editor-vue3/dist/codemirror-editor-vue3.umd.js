var ke=Object.defineProperty,we=Object.defineProperties;var $e=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var N=(l,d,t)=>d in l?ke(l,d,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[d]=t,E=(l,d)=>{for(var t in d||(d={}))_e.call(d,t)&&N(l,t,d[t]);if(D)for(var t of D(d))ve.call(d,t)&&N(l,t,d[t]);return l},A=(l,d)=>we(l,$e(d));(function(l,d){typeof exports=="object"&&typeof module!="undefined"?d(exports,require("codemirror/lib/codemirror.css"),require("vue"),require("codemirror"),require("codemirror/addon/merge/merge.css"),require("codemirror/addon/merge/merge.js"),require("diff-match-patch"),require("codemirror/addon/mode/simple.js"),require("codemirror/lib/codemirror.js")):typeof define=="function"&&define.amd?define(["exports","codemirror/lib/codemirror.css","vue","codemirror","codemirror/addon/merge/merge.css","codemirror/addon/merge/merge.js","diff-match-patch","codemirror/addon/mode/simple.js","codemirror/lib/codemirror.js"],d):(l=typeof globalThis!="undefined"?globalThis:l||self,d(l["codemirror-editor-vue3"]={},null,l.Vue,l.codemirror,null,null,l.DiffMatchPatch,null,l.codemirror))})(this,function(l,d,t,B,be,Me,R,Ee,V){"use strict";function S(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function F(e){if(e&&e.__esModule)return e;var n={__proto__:null,[Symbol.toStringTag]:"Module"};return e&&Object.keys(e).forEach(function(r){if(r!=="default"){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}}),n.default=e,Object.freeze(n)}var w=S(B),P=S(R),q=F(V),$=(e,n)=>{const r=e.__vccOpts||e;for(const[a,o]of n)r[a]=o;return r};const z=window.CodeMirror||w.default,H=t.defineComponent({name:"defaultMode",props:{name:{type:String,default:`cm-textarea-${+new Date}`},value:String,content:String,options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})},placeholder:{type:String,default:""}},emits:["update:cminstance","ready"],setup(e,{emit:n}){const r=t.ref(),a=t.ref(null),o=()=>{a.value=t.markRaw(z.fromTextArea(r.value,e.options)),n("update:cminstance",a.value);let i=null;i=t.watch(()=>e.cminstance,(s,h)=>{s&&e.cminstance.setValue(e.value||e.content),n("ready",a),i()},{deep:!0})};return t.onMounted(()=>{o()}),{initialize:o,textarea:r}}}),U=["name","placeholder"];function W(e,n,r,a,o,i){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,U)}var J=$(H,[["render",W]]);const K=(window==null?void 0:window.CodeMirror)||w.default;window.diff_match_patch=P.default,window.DIFF_DELETE=-1,window.DIFF_INSERT=1,window.DIFF_EQUAL=0;const G=t.defineComponent({name:"mergeMode",props:{name:{type:String,default:`cm-mergeView-${new Date().toString()}`},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})}},emits:["update:cminstance","ready"],setup(e,{emit:n}){const r=t.ref(null),a=t.ref(null),o=()=>{r.value=t.markRaw(K.MergeView(a.value,e.options)),n("update:cminstance",r.value.edit),n("ready",r)};return t.onMounted(()=>{o()}),{mergeView:a,initialize:o}}}),Z=["name"];function Q(e,n,r,a,o,i){return t.openBlock(),t.createElementBlock("div",{ref:"mergeView",name:e.$props.name},null,8,Z)}var X=$(G,[["render",Q]]),C;(function(e){e.info="info",e.warning="warning",e.error="error"})(C||(C={}));function O(){const e=new Date,n=e.getHours()<10?"0"+e.getHours():e.getHours(),r=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),a=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return`${n}:${r}:${a}`}function Y(e){return`#link#${JSON.stringify(e)}#link#`}function j(e){const n=/#link#(.+)#link#/g;let r=[],a;for(a=n.exec(e);a;){const o=document.createElement("a"),i=JSON.parse(a[1]),s=Object.entries(i);for(let[h,m]of s)o.setAttribute(h,m);o.className="editor_custom_link",o.innerHTML="logDownload",r.push({start:a.index,end:a.index+a[0].length,node:o}),a=n.exec(e)}return r}function ee(e="",n="info"){return`#log<${n}>log#${e}#log<${n}>log#`}function x(e){let n=[];function r(){const a=new RegExp(`#log<(\\w*)>log#((.|\r
|
)*?)#log<(\\w*)>log#`,"g");let o;for(o=a.exec(e);o;){let s=o[0].replace(/\r\n/g,`
`).split(`
`),m=o[2].replace(/\r\n/g,`
`).split(`
`);const f=document.createElement("span");let u=o[1];f.className=`c-editor--log__${u}`;let c=0;for(let g=0;g<s.length;g++){let v=s[g],b=m[g],M=f.cloneNode(!1);M.innerText=b,n.push({start:o.index+c,end:o.index+c+v.length,node:M}),c=c+v.length+1}o=a.exec(e)}}return r(),n}function te(e,n=""){return`[${O()}] <${n}> ${e}`}function ne(e="",n=20,r="="){const a=Math.floor(1.5*e.length/2),i=new Array(Math.max(n-a,5)).join(r);return`${i}${e}${i}`}const _=[{regex:/(\[.*?\])([ \t]*)(<error>[ \t])(.+)/,token:["tag",null,"error.strong","error.strong"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<info>)(.+)(.?)/,token:["tag",null,"bracket","bracket","hr"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<warning>)(.+)(.?)/,token:["tag",null,"comment","comment","hr"],sol:!0}];w.default.defineSimpleMode("fclog",{start:[..._,{regex:/.*/,token:"hr"}],error:[..._,{regex:/.*/,token:"error.strong"}],info:[..._,{regex:/.*/,token:"bracket"}],warning:[..._,{regex:/.*\[/,token:"comment"}]}),q.defineSimpleMode("log",{start:[{regex:/^[=]+[^=]*[=]+/,token:"strong"},{regex:/([^\w])([A-Z][\w]*)/,token:[null,"string"]},{regex:/(^[A-Z][\w]*)/,token:"string"}]});const re=window.CodeMirror||w.default,oe=t.defineComponent({name:"codemirror-fclog",props:{value:String,content:String,name:{type:String,default:`cm-textarea-${+new Date}`},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})},placeholder:{type:String,default:""}},emits:["update:cminstance","ready"],setup(e,{emit:n}){const r=t.ref(),a=t.ref(null),o=(s=e.cminstance)=>{s.getAllMarks().forEach(u=>u.clear());const m=s.getValue(),f=[].concat(j(m)).concat(x(m));for(let u=0;u<f.length;u++){const c=f[u];s.markText(s.posFromIndex(c.start),s.posFromIndex(c.end),{replacedWith:c.node})}},i=()=>{a.value=t.markRaw(re.fromTextArea(r.value,e.options)),n("update:cminstance",t.markRaw(a.value)),a.value.on("change",o)};return t.watch(()=>e.cminstance,s=>{s&&(o(e.cminstance),e.cminstance.setValue(e.value||e.content),n("ready",a))},{deep:!0,immediate:!0}),t.onMounted(()=>{i()}),{initialize:i,textarea:r}}}),ae=["name","placeholder"];function le(e,n,r,a,o,i){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,ae)}var ie=$(oe,[["render",le]]);function ce(e){Promise.resolve().then(()=>{let n=e.getScrollInfo();e.scrollTo(n.left,n.height)})}function se({props:e,cminstance:n,ctx:r,internalInstance:a,content:o,componentsEvts:i}){const s=()=>{let m=[];return Object.keys(a.vnode.props).forEach(f=>{if(f.startsWith("on")){let u=f.replace(f[2],f[2].toLowerCase()).slice(2);!i.includes(u)&&m.push(u)}}),m};return{listenerEvents:()=>{n.value.on("change",c=>{const g=c.getValue();g!=o.value&&(o.value=g,r.emit("update:value",o.value),r.emit("input",o.value),Promise.resolve().then(()=>{r.emit("change",o.value,c)}),e.KeepCursorInEnd&&ce(c))});const m={};return s().filter(c=>!m[c]&&(m[c]=!0)).forEach(c=>{n.value.on(c,(...g)=>{r.emit(c,...g)})})}}}function ue({props:e,cminstance:n,presetRef:r}){const a=t.ref(null),o=t.ref(null),i=()=>{t.nextTick(()=>{n.value.refresh()})},s=(u=e.width,c=e.height)=>{a.value=String(u).replace("px",""),o.value=String(c).replace("px","");let g=o.value;n.value.setSize(a.value,g)},h=()=>{const u=n.value.doc.cm.getWrapperElement();u==null||u.remove()},m=()=>document.querySelector(".CodeMirror-gutters").style.left.replace("px","")!="0";return{refresh:i,resize:s,destroy:h,containerHeight:o,reviseStyle:()=>{if(i(),!m())return;let u=setInterval(()=>{m()?i():clearInterval(u)},60),c=setTimeout(()=>{clearInterval(u),clearTimeout(c),u=null,c=null},400)}}}const L=["update:value","change","input","ready"],de=["changes","scroll","beforeChange","cursorActivity","keyHandled","inputRead","electricInput","beforeSelectionChange","viewportChange","swapDoc","gutterClick","gutterContextMenu","focus","blur","refresh","optionChange","scrollCursorIntoView","update"],me={mode:"text",theme:"default",lineNumbers:!0,smartIndent:!0,indentUnit:2,foldGutter:!0,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!0};typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value(e,n){if(e==null)throw new TypeError("Cannot convert undefined or null to object");const r=Object(e);for(let a=1;a<arguments.length;a++){const o=arguments[a];if(o!=null)for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])}return r},writable:!0,configurable:!0});const fe=t.defineComponent({name:"CodemirrorEditor",props:{value:String,marker:Function,unseenLines:Array,name:{type:String,default:""},placeholder:{type:String,default:""},merge:{type:Boolean,default:!1},options:{type:Object,default:()=>({})},globalOptions:{type:Object,default:()=>({})},border:{type:Boolean,default:!1},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},KeepCursorInEnd:{type:Boolean,default:!1}},emits:[...L,...de],components:{Default:J,Merge:X,FcLog:ie},setup(e,n){var T,I;const r=t.ref(null),a=t.ref(""),o=t.ref("Default"),i=t.ref(Object.assign(E({},me),e.globalOptions,e.options)),s=t.getCurrentInstance(),h=t.ref(null),{refresh:m,resize:f,destroy:u,containerHeight:c,reviseStyle:g}=ue({props:e,cminstance:r,presetRef:h}),{listenerEvents:v}=se({props:e,cminstance:r,ctx:n,internalInstance:s,content:a,componentsEvts:L}),b=()=>{e.unseenLines!==void 0&&e.marker!==void 0&&e.unseenLines.forEach(p=>{const y=r.value.lineInfo(p);r.value.setGutterMarker(p,"breakpoints",y.gutterMarkers?null:e.marker())})},M=p=>{const y=r.value.getValue();p!==y&&(r.value.setValue(p),a.value=p,g()),b()},pe=p=>{v(),b(),f(),n.emit("ready",r.value),t.watch([()=>e.height,()=>e.width],([y,ye])=>{f(y,ye)},{deep:!0})},he=()=>{if(e.options.mode=="fclog"||e.options.mode=="log"){o.value="FcLog";return}if(e.merge){o.value="Merge";return}o.value="default"};return t.watch(()=>e.options,p=>{for(const y in e.options)r.value.setOption(y,p[y])},{deep:!0}),t.watch(()=>e.value,p=>{M(p)}),t.watch(()=>e.merge,p=>{he()},{immediate:!0}),t.onBeforeUnmount(()=>{u()}),{presetModeName:o,cmOptions:i,cminstance:r,content:a,ready:pe,resize:f,containerHeight:c,instanceName:e.name||((I=(T=s==null?void 0:s.parent)==null?void 0:T.type)==null?void 0:I.name)||void 0,presetRef:h}}});function ge(e,n,r,a,o,i){return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["codemirror-container",{merge:e.$props.merge,bordered:e.$props.border||e.$props.merge,"width-auto":!e.$props.width||e.$props.width=="100%","height-auto":!e.$props.height||e.$props.height=="100%"}]),style:t.normalizeStyle({height:e.containerHeight+"px"})},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.presetModeName),t.mergeProps({style:{height:"100%"},ref:"presetRef",cminstance:e.cminstance,"onUpdate:cminstance":n[0]||(n[0]=s=>e.cminstance=s)},A(E(E({},e.$props),e.$attrs),{options:e.cmOptions,name:e.instanceName,content:e.content}),{onReady:e.ready}),null,16,["cminstance","onReady"]))],6)}var k=$(fe,[["render",ge]]),Se="",Ce="";k.install=(e,n)=>(n&&(n.options&&(k.props.globalOptions.default=()=>n.options),n.events&&(k.props.globalEvents.default=()=>n.events)),e.component("Codemirror",k),e),function styleInject(css,ref){if(ref===void 0){ref={}}var insertAt=ref.insertAt;if(!css||typeof document==="undefined"){return}var head=document.head||document.getElementsByTagName("head")[0];var style=document.createElement("style");style.type="text/css";if(insertAt==="top"){if(head.firstChild){head.insertBefore(style,head.firstChild)}else{head.appendChild(style)}}else{head.appendChild(style)}if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}};styleInject(`.codemirror-container {
  position: relative;
  display: inline-block;
  height: 100%;
  width: fit-content;
  font-size: 12px;
  overflow: hidden;
}
.codemirror-container.bordered {
  border-radius: 4px;
  border: 1px solid #dddddd;
}
.codemirror-container.width-auto {
  width: 100%;
}
.codemirror-container.height-auto {
  height: 100%;
}
.codemirror-container.height-auto .CodeMirror,
.codemirror-container.height-auto .cm-s-default {
  height: 100% !important;
}
.CodeMirror-lines .CodeMirror-placeholder.CodeMirror-line-like {
  color: #666;
}
.CodeMirror,
.CodeMirror-merge-pane {
  height: 100%;
  font-family: consolas !important;
}
.CodeMirror-merge,
.CodeMirror-merge-right .CodeMirror {
  height: 100%;
  border: none !important;
}
.editor_custom_link {
  cursor: pointer;
  color: #1474f1;
  text-decoration: underline;
}
.editor_custom_link:hover {
  color: #04b4fa;
}
.c-editor--log__error {
  color: #bb0606;
  font-weight: bold;
}
.c-editor--log__info {
  color: #333333;
  font-weight: bold;
}
.c-editor--log__warning {
  color: #ee9900;
}
.c-editor--log__success {
  color: #669600;
}
.cm-header,
.cm-strong {
  font-weight: bold;
}
`),l.Codemirror=k,l.createLinkMark=Y,l.createLog=te,l.createLogMark=ee,l.createTitle=ne,l.default=k,l.getLinkMark=j,l.getLocalTime=O,l.getLogMark=x,Object.defineProperty(l,"__esModule",{value:!0}),l[Symbol.toStringTag]="Module"});
